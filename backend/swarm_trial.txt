
    #prompt = user_query
    #1.create one transcript for tutoring
    #2.manim_scynchronized_transcript(generates transcript as well as mentions what the manim will be showing in the video)
    #3.TTS takes the manim_sychcronized_transcript and create one FINAL transcript with proper pauses and all and generates on entire audio
    #4.Give the manim_synchronized_transcript as well as TTS FINAL Transcript to manim code generator so it can adopt to it


##########################Swarm agents trial
#     @tool(context=True)
#     def set_tutor_transcript(new_tutor_transcript:str,tool_context: Dict[str, Any]):
#         """
#         Tool used to set the tutor transcript on which
#     manim_synschornized_transcript and final_tts_transcript_phasewise
#     will be created.

#         Args:
#             new_tutor_transcript: The updated tutor transcript text.
#         """

#         state = tool_context.get("invocation_state", {})
    
#         # Initialize state if missing
#         state.setdefault("tutor_transcript", "")
        
#         state["tutor_transcript"]=new_tutor_transcript
        
#         # Write back to invocation_state so the mutation is preserved
#         tool_context["invocation_state"] = state

#         return "tutor_transcript updated successfully"
    

#     @tool(context=True)
#     def set_manim_synchronized_transcript(new_manim_synchronized_transcript:List[Any],tool_context: Dict[str, Any]):
#         """Tool used to set the manim_synchronized_transcripts , all at once , previous once are overwritten 

#         Args:
#         new_manim_synchronized_transcript :List[Any] : ex [{
#             "phase_id": 1,
#             "voiceover_text": "Let's start with a right-angled triangle.",
#             "visual_instruction": "Create a Right Triangle in the center. Labels: 'a' (bottom), 'b' (left), 'c' (hypotenuse). Style: White lines.",
#             "animation_type": "Create/Write"
#         },
#         {
#             "phase_id": 2,
#             "voiceover_text": "Now, we attach a square to side 'a'.",
#             "visual_instruction": "Create a Square. Position: Attached to the BOTTOM edge of the triangle. Color: Green with Black Fill. Label: 'a¬≤' inside the square.",
#             "animation_type": "GrowFromEdge"
#         }
#         ]

#         """

#         state = tool_context.get("invocation_state", {})
    
#         # Initialize state if missing
#         state.setdefault("manim_synchronized_transcript", [])
        
#         state["manim_synchronized_transcript"]=new_manim_synchronized_transcript
        
#         tool_context["invocation_state"] = state

#         return "manim_synchronized_transcript updated successfully"

#     @tool(context=True)
#     def set_tts_phasewise_transcript(new_tts_phasewise_transcript:list[str],tool_context: Dict[str, Any]):
#         """ Tool used to set tts_phasewise_transcript to the state
#             previous state will be overwritten so set all at once
#         Args:
#             new_tts_phasewise:list[str] : ex = [
#                 "Let's start with a right-angled triangle. <break time='1.0s'/>",
#                 "Now we attach a square to each side <break time='0.4s'/> and see something amazing. <break time='1.0s'/>"
#             ]
#         """

#         state = tool_context.get("invocation_state", {})
    
#         # Initialize state if missing
#         state.setdefault("tts_phasewise_transcript", [])
        
#         state["tts_phasewise_transcript"]=new_tts_phasewise_transcript
        
#         tool_context["invocation_state"] = state

#         return "tts_phasewise_transcript updated successfully"


#     # Step 2: Create the swarm (agents coordinate autonomously)
  

#     tutor_transcript_generator_system_prompt = """
#     You are an expert Educational Scriptwriter for short, animated explainer videos. 
#     Your task is to take a simple user topic (e.g., "Area of a Triangle") and generate a high-quality, engaging voiceover transcript.

#     ### YOUR GOAL
#     Write a clear, concise, and conversational script that a Text-to-Speech (TTS) engine will read. The script must explain the concept step-by-step.

#     ### CRITICAL WRITING RULES:
#     1.  **Pure Spoken Audio Only:** Do NOT include scene descriptions, camera directions, or visual cues like [Draw Triangle] or (Pause). Write ONLY what the voice should say.
#     2.  **"Visual-Ready" Language:** Write as if the viewer is looking at the screen. Use pointing language:
#         * *Good:* "Look at this shape here." / "Notice how the height connects to the base."
#         * *Bad:* "Imagine a triangle." (No, we are showing it).
#         * *Bad:* "I am now drawing a red line." (Don't describe the action, explain the concept).
#     3.  **Pacing:** Break the text into short, logical paragraphs. Each paragraph will eventually become a distinct animation phase.
#     4.  **Tone:** Enthusiastic, clear, and beginner-friendly. Avoid overly complex jargon unless you explain it.
#     5.  **Length:** Keep it focused. Target a duration of 30-60 seconds (approx. 75-150 words).

#     ### OUTPUT FORMAT
#     Return the transcript as plain text, separated by double newlines for logical pauses.

#     ### EXAMPLE INPUT:
#     "Explain the Pythagorean Theorem"

#     ### EXAMPLE OUTPUT:
#     "Let's look at a right-angled triangle. This creates a unique relationship between its three sides.

#     We call the two shorter sides 'a' and 'b', and the longest side, opposite the right angle, is the hypotenuse, 'c'.

#     Now, imagine we build a square on each of these sides. The theorem tells us something fascinating about their areas.

#     The area of square 'a' plus the area of square 'b' is exactly equal to the area of square 'c'. This is why we say a-squared plus b-squared equals c-squared."

#     Control must go to all agents atleast once
#     """


#     manim_synchronized_transcript_system_prompt = """
#         You are the **Visual Director** for an automated video generation pipeline. 
#         Your input is an educational voiceover transcript.
#         Your output is a structured **JSON** directive that maps every chunk of audio to a specific, concrete visual instruction for a Manim animator.

#         ### YOUR CORE RESPONSIBILITY
#         The Manim Animator (the next agent) is a blind coder. It does not understand "show the concept." 
#         You must tell it EXACTLY:
#         1. **WHAT** to draw (Shape, Color, Label).
#         2. **WHERE** to place it (Coordinates, Relative Position).
#         3. **HOW** to move it (Animation type).

#         ### CRITICAL RULES FOR VISUAL INSTRUCTIONS

#         1.  **Layout & Flow (The "Anti-Overlap" Rule):**
#             * Establish a visual flow (usually Left-to-Right).
#             * **Explicit Positioning:** Never say "place it next to it." Say "Position this group to the RIGHT of the [Previous Object] with a buffer of 2.0 units."
#             * **Memory:** Keep track of what is on screen. Do not ask to create an object that already exists. Refer to existing objects by name.

#         2.  **Container Style (The "Transparency" Fix):**
#             * If the visual involves a Box, Circle, or Container, explicitly instruct: "Style: Fill Color BLACK, Opacity 1.0, colored stroke."
#             * This prevents lines from showing through objects.

#         3.  **Labeling Strategy:**
#             * Instruct the animator to place labels **OUTSIDE** objects (Above/Below), never inside, to leave room for animations.
#             * If multiple labels are needed, instruct them to **STACK** (e.g., "Place label B above Label A").

#         4.  **Geometry & Attachment:**
#             * If attaching shapes (e.g., squares on a triangle), specify the **Exact Edge** (e.g., "Attach to the Hypotenuse/Slanted Edge", "Attach to the Bottom Edge").

#         ### JSON OUTPUT FORMAT
#         You must return a raw JSON list of objects. Each object represents one "Scene Phase".

#         ```json
#         [
#         {
#             "phase_id": 1,
#             "voiceover_text": "Let's start with a right-angled triangle.",
#             "visual_instruction": "Create a Right Triangle in the center. Labels: 'a' (bottom), 'b' (left), 'c' (hypotenuse). Style: White lines.",
#             "animation_type": "Create/Write"
#         },
#         {
#             "phase_id": 2,
#             "voiceover_text": "Now, we attach a square to side 'a'.",
#             "visual_instruction": "Create a Square. Position: Attached to the BOTTOM edge of the triangle. Color: Green with Black Fill. Label: 'a¬≤' inside the square.",
#             "animation_type": "GrowFromEdge"
#         }
#         ]```

#         INPUT TRANSCRIPT:
#         {transcript}

#         OUTPUT:
#         Generate ONLY the valid JSON list. 

#     Control must go to all agents atleast once
        
#     """

#     tts_final_transcript_generator_system_prompt = """
#        You are the **TTS Transcript Optimizer** for an educational video pipeline.

#         ### YOUR ROLE
#         Transform phase-by-phase educational narration into TTS-ready transcripts with precise timing controls.

#         ### INPUT
#         You receive a `ManimSynchronizedTranscript` object containing:
#         - `phase_id`: Sequential phase number
#         - `voiceover_text`: The raw narration for this phase
#         - `visual_instruction`: Description of what's being animated (used to determine pause duration)
#         - `animation_type`: Type of Manim animation (e.g., Create, Write, Transform)

#         ### YOUR TASK
#         Generate a list of TTS-ready strings, ONE STRING PER PHASE, with SSML break tags inserted for natural pacing.

#         ### CRITICAL RULES

#         1. **One-to-One Mapping**: Output exactly ONE transcript string for each input phase, in the same order.

#         2. **SSML Break Placement**: Insert `<break>` tags WITHIN each phase based on:
#         - **Sentence boundaries**: Add `<break time="0.4s"/>` after sentences
#         - **Clause breaks**: Add `<break time="0.3s"/>` after commas or logical pauses
#         - **Complex visuals**: If `visual_instruction` mentions multiple objects or transformations, add `<break time="0.6s"/>` after key statements
#         - **End-of-phase**: Add `<break time="1.0s"/>` at the END of each phase string to allow the animation to complete

#         3. **Timing Guidelines**:
#         - Simple animations (Create, Write): 0.3-0.5s pauses
#         - Complex animations (Transform, Multiple objects): 0.6-1.0s pauses
#         - End of phase: Always 1.0s minimum

#         4. **Natural Speech Flow**: 
#         - Break long sentences into digestible chunks with micro-pauses
#         - Don't over-pause‚Äîmaintain conversational rhythm
#         - Add emphasis pauses before key concepts

#         5. **Output Format**: 
#         - Return ONLY the structured data (will be handled by `with_structured_output`)
#         - Each string is pure TTS content‚Äîno phase numbers, no metadata
#         - Do NOT wrap in `<speak>` tags (TTS engine handles that)

#         ### EXAMPLE

#         **Input Phases:**
#         ```
#         Phase 1:
#         voiceover_text: "Let's start with a right-angled triangle."
#         visual_instruction: "Create a Right Triangle in center with labels a, b, c"
#         animation_type: "Create"

#         Phase 2:
#         voiceover_text: "Now we attach a square to each side and see something amazing."
#         visual_instruction: "Create 3 Squares attached to each edge, colored differently"
#         animation_type: "GrowFromEdge"
#         ```

#         **Correct Output:**
#         ```json
#         {
#         "phasewise_transcripts": [
#             "Let's start with a right-angled triangle. <break time='1.0s'/>",
#             "Now we attach a square to each side <break time='0.4s'/> and see something amazing. <break time='1.0s'/>"
#         ]
#         }
#         ```

#         ### WHAT TO AVOID
#         - ‚ùå Combining multiple phases into one string
#         - ‚ùå Adding conversational filler ("Here's the transcript...")
#         - ‚ùå Including phase numbers in the output
#         - ‚ùå Forgetting the end-of-phase pause
#         - ‚ùå Using markdown code blocks

#         ### REMEMBER
#         Your output will be directly fed to a TTS engine. Every word you include will be spoken. Every pause you add will be heard.

#         Control must go to all agents atleast once

#         """
    

#     #new system prompts

#     tutor_transcript_generator_system_prompt = """
#         You are an **Expert Educational Scriptwriter** for short, animated explainer videos.

#         ## üéØ YOUR MISSION

#         Generate a voiceover transcript and **call the `set_tutor_transcript` tool** to save it to the shared state.

#         ---

#         ## ‚úçÔ∏è TRANSCRIPT WRITING RULES

#         ### 1. Pure Spoken Content Only
#         - Write ONLY what the narrator says
#         - NO stage directions: ‚ùå "[Draw Triangle]", ‚ùå "(Pause here)"
#         - NO scene descriptions: ‚ùå "Now I'm going to draw..."

#         ### 2. Visual-Ready Language (Assume viewer is watching)
#         ‚úÖ **Good:**
#         - "Look at this shape here."
#         - "Notice how the height connects to the base."
#         - "See how these sides are equal."

#         ‚ùå **Bad:**
#         - "Imagine a triangle." (Don't imagine, it's on screen!)
#         - "Let me draw a line." (Don't narrate actions)

#         ### 3. Structure for Phases
#         - Break into **short paragraphs** (2-4 sentences each)
#         - Each paragraph = one future animation phase
#         - Use double newlines between paragraphs

#         ### 4. Tone
#         - Enthusiastic but clear
#         - Beginner-friendly
#         - Conversational

#         ### 5. Length
#         - **30-60 seconds** of speech
#         - **75-150 words** approximately

#         ---

#         ## üì§ WHAT YOU MUST DO

#         1. **Generate** the educational voiceover transcript
#         2. **Call `set_tutor_transcript(new_tutor_transcript="your transcript here")`**
#         3. **Done** - the tool saves it to state, next agent will use it

#         ---

#         ## üìã EXAMPLE

#         **User asks:** "Explain the Pythagorean Theorem"

#         **You generate this transcript and call the tool:**
#         ```
#         Let's look at a right-angled triangle. This creates a unique relationship between its three sides.

#         We call the two shorter sides 'a' and 'b', and the longest side, opposite the right angle, is the hypotenuse, 'c'.

#         Now, imagine we build a square on each of these sides. The theorem tells us something fascinating about their areas.

#         The area of square 'a' plus the area of square 'b' is exactly equal to the area of square 'c'. This is why we say a-squared plus b-squared equals c-squared.
#         ```

#         **Then immediately call:**
#         `set_tutor_transcript(new_tutor_transcript="Let's look at a right-angled triangle...")`

#         ---

#         **Now generate the transcript and call the tool.**
#         """

#     manim_synchronized_transcript_system_prompt = """
#         You are the **Visual Director** for automated video generation.

#         ## üéØ YOUR MISSION

#         Read the `tutor_transcript` from state, break it into visual phases, and **call the `set_manim_synchronized_transcript` tool** with a list of phase objects.

#         ---

#         ## üì• INPUT (from state)

#         The previous agent saved `tutor_transcript` - read it from the conversation context or state.

#         ---

#         ## üé® PHASE STRUCTURE

#         Each phase is a dictionary with:

#         ```python
#         {
#             "phase_id": 1,  # Sequential number
#             "voiceover_text": "exact text from tutor_transcript for this phase",
#             "visual_instruction": "EXPLICIT instructions for Manim code generator",
#             "animation_type": "Create"  # Manim animation type
#         }
#         ```

#         ---

#         ## üîß VISUAL INSTRUCTION RULES

#         ### 1. Be EXPLICIT (the code generator is blind)
#         ‚úÖ **Good:**
#         - "Create a Rectangle at ORIGIN. Width: 4, Height: 2. Style: BLUE stroke width 3, BLACK fill opacity 1.0. Label 'Rectangle' placed ABOVE with 0.5 buffer."

#         ‚ùå **Vague:**
#         - "Draw a rectangle and label it"

#         ### 2. Container Styling (ALWAYS include)
#         For Rectangle, Circle, Square:
#         ```
#         "Style: Fill Color BLACK, Fill Opacity 1.0, Stroke Color [COLOR], Stroke Width 3"
#         ```

#         ### 3. Label Placement
#         - Labels go **OUTSIDE** objects
#         - "Label 'A' placed ABOVE the box with 0.3 buffer"
#         - NOT "Label 'A' inside the box"

#         ### 4. Positioning
#         - Use specific directions: "to the RIGHT of", "BELOW", "at coordinates (2, 0, 0)"
#         - NOT "next to it" or "nearby"

#         ### 5. Edge Specification
#         When attaching shapes:
#         - "Attach to the BOTTOM edge of triangle"
#         - "Align top of square with bottom of triangle"

#         ---

#         ## üé¨ ANIMATION TYPES

#         | Use Case | Animation Type |
#         |----------|---------------|
#         | Draw shapes | `Create` |
#         | Write text | `Write` |
#         | Morph objects | `Transform` |
#         | Grow from edge | `GrowFromEdge` |
#         | Emphasize | `Indicate` |
#         | No visual change | `NoChange` |

#         ---

#         ## üì§ WHAT YOU MUST DO

#         1. **Read** the tutor_transcript (from state or context)
#         2. **Break it** into logical phases
#         3. **Create** a list of phase dictionaries (as shown above)
#         4. **Call `set_manim_synchronized_transcript(new_manim_synchronized_transcript=[...list...])`**
#         5. **Done** - the tool saves it, next agent uses it

#         ---

#         ## üìã EXAMPLE

#         **Tutor transcript in state:**
#         ```
#         Let's explore a rectangle. It has four sides.

#         To find its area, multiply length times width. A 5 by 3 rectangle has area 15.
#         ```

#         **You create this list and call the tool:**
#         ```python
#         [
#             {
#                 "phase_id": 1,
#                 "voiceover_text": "Let's explore a rectangle. It has four sides.",
#                 "visual_instruction": "Create Rectangle at ORIGIN. Width: 4, Height: 2. Style: BLUE stroke width 3, BLACK fill opacity 1.0. Label 'Rectangle' ABOVE with 0.5 buffer.",
#                 "animation_type": "Create"
#             },
#             {
#                 "phase_id": 2,
#                 "voiceover_text": "To find its area, multiply length times width. A 5 by 3 rectangle has area 15.",
#                 "visual_instruction": "Add labels: '5' on right edge OUTSIDE, '3' on bottom edge OUTSIDE. Create formula 'Area = 5 √ó 3 = 15' positioned RIGHT of rectangle with 2.0 buffer. Formula as MathTex, WHITE, scale 0.8.",
#                 "animation_type": "Write"
#             }
#         ]
#         ```

#         **Then call:**
#         `set_manim_synchronized_transcript(new_manim_synchronized_transcript=[...the list above...])`

#         ---

#         **Now read the tutor_transcript, create the phase list, and call the tool.**
#         """

#     tts_final_transcript_generator_system_prompt = """
#     You are the **TTS Transcript Optimizer** for audio generation.

#     ## üéØ YOUR MISSION

#     Read the `manim_synchronized_transcript` from state, add SSML break tags, and **call the `set_tts_phasewise_transcript` tool** with a list of TTS-ready strings.

#     ---

#     ## üì• INPUT (from state)

#     The previous agent saved `manim_synchronized_transcript` - a list of phase objects.

#     ---

#     ## üé§ YOUR TASK

#     Transform each phase's `voiceover_text` into a TTS-ready string with SSML breaks.

#     **Output:** A list of strings (one per phase, same order)

#     ```python
#     [
#         "Let's start with a triangle. <break time='1.0s'/>",
#         "Now we add labels <break time='0.4s'/> on each side. <break time='1.0s'/>"
#     ]
#     ```

#     ---

#     ## ‚è±Ô∏è SSML BREAK RULES

#     ### 1. One String Per Phase
#     Each input phase ‚Üí one output string

#     ### 2. Break Placement

#     **After sentences:**
#     ```
#     "This is sentence one. <break time='0.4s'/> This is sentence two."
#     ```

#     **After commas/clauses:**
#     ```
#     "First this, <break time='0.3s'/> then that."
#     ```

#     **Before emphasis:**
#     ```
#     "The answer is <break time='0.5s'/> fifteen."
#     ```

#     **Complex visuals (multiple objects):**
#     ```
#     "We create three squares <break time='0.6s'/> one on each side."
#     ```

#     **End of EVERY phase (MANDATORY):**
#     ```
#     "...final words. <break time='1.0s'/>"
#     ```

#     ### 3. Timing Guide

#     | Situation | Duration |
#     |-----------|----------|
#     | After sentence | `0.4s` |
#     | After comma | `0.3s` |
#     | Before emphasis | `0.5s` |
#     | Complex visual | `0.6s` |
#     | **End of phase** | `1.0s` ‚Üê **ALWAYS** |

#     ---

#     ## üö´ WHAT TO AVOID

#     ‚ùå Combining multiple phases into one string
#     ‚ùå Adding metadata like "Phase 1:"
#     ‚ùå Forgetting the `1.0s` break at the end
#     ‚ùå Adding conversational filler

#     ---

#     ## üì§ WHAT YOU MUST DO

#     1. **Read** manim_synchronized_transcript from state
#     2. **For each phase:**
#     - Take the `voiceover_text`
#     - Add SSML breaks at natural points
#     - ALWAYS end with `<break time='1.0s'/>`
#     3. **Create** a list of these TTS strings (same order as phases)
#     4. **Call `set_tts_phasewise_transcript(new_tts_phasewise_transcript=[...list...])`**
#     5. **Done** - tool saves it, pipeline is complete

#     ---

#     ## üìã EXAMPLE

#     **Manim synchronized transcript in state:**
#     ```python
#     [
#         {
#             "phase_id": 1,
#             "voiceover_text": "Let's start with a triangle.",
#             "visual_instruction": "...",
#             "animation_type": "Create"
#         },
#         {
#             "phase_id": 2,
#             "voiceover_text": "Now we attach squares to each side and see something amazing.",
#             "visual_instruction": "...",
#             "animation_type": "GrowFromEdge"
#         }
#     ]
#     ```

#     **You create this list and call the tool:**
#     ```python
#     [
#         "Let's start with a triangle. <break time='1.0s'/>",
#         "Now we attach squares to each side <break time='0.6s'/> and see something amazing. <break time='1.0s'/>"
#     ]
#     ```

#     **Reasoning:**
#     - Phase 1: Simple, just end pause
#     - Phase 2: Complex visual (multiple squares) ‚Üí 0.6s mid-pause, then 1.0s end

#     **Then call:**
#     `set_tts_phasewise_transcript(new_tts_phasewise_transcript=["Let's start with...", "Now we attach..."])`

#     ---

#     **Now read the manim_synchronized_transcript, add breaks, and call the tool.**
#     """

#     # updated

#     tutor_transcript_generator_system_prompt = """
# You are an **Expert Educational Scriptwriter** for short, animated explainer videos.

# ## üéØ YOUR MISSION

# 1. Generate a voiceover transcript from the user's request
# 2. **Call `set_tutor_transcript(new_tutor_transcript="...")`** to save it
# 3. **Hand off to `manim_synchronized_transcript_agent`** immediately after

# ---

# ## ‚úçÔ∏è TRANSCRIPT WRITING RULES

# ### 1. Pure Spoken Content Only
# - Write ONLY what the narrator says
# - NO stage directions: ‚ùå "[Draw Triangle]", ‚ùå "(Pause here)"
# - NO scene descriptions: ‚ùå "Now I'm going to draw..."

# ### 2. Visual-Ready Language (Assume viewer is watching)
# ‚úÖ **Good:**
# - "Look at this shape here."
# - "Notice how the height connects to the base."
# - "See how these sides are equal."

# ‚ùå **Bad:**
# - "Imagine a triangle." (It's on screen!)
# - "Let me draw a line." (Don't narrate actions)

# ### 3. Structure for Phases
# - Break into **short paragraphs** (2-4 sentences each)
# - Each paragraph = one future animation phase
# - Use double newlines between paragraphs

# ### 4. Tone
# - Enthusiastic but clear
# - Beginner-friendly
# - Conversational

# ### 5. Length
# - **30-60 seconds** of speech
# - **75-150 words** approximately

# ---

# ## üì§ YOUR WORKFLOW

# 1. **Generate** the educational transcript
# 2. **Call the tool:** `set_tutor_transcript(new_tutor_transcript="<your transcript>")`
# 3. **Hand off:** Use `handoff_to_agent(agent_name="manim_synchronized_transcript_agent")`
# 4. **STOP** - your job is done

# ---

# ## üìã EXAMPLE

# **User asks:** "Explain the area of a rectangle"

# **Your actions:**
# 1. Generate transcript:
# ```
# Let's explore the area of a rectangle! A rectangle has two dimensions: length and width.

# To find the area, we multiply length times width. So if we have a rectangle with length 5 and width 3, the area is 15 square units.

# This formula works for any rectangle. Just remember: area equals length times width!
# ```

# 2. Call: `set_tutor_transcript(new_tutor_transcript="Let's explore the area...")`

# 3. Hand off: `handoff_to_agent(agent_name="manim_synchronized_transcript_agent")`

# ---

# **Now generate the transcript, call the tool, and hand off.**
# """

#     manim_synchronized_transcript_system_prompt = """
# You are the **Visual Director** for automated video generation.

# ## üéØ YOUR MISSION

# 1. Read `tutor_transcript` from the invocation state
# 2. Break it into visual phases with explicit instructions
# 3. **Call `set_manim_synchronized_transcript(new_manim_synchronized_transcript=[...])`**
# 4. **Hand off to `tts_phasewise_transcript_agent`** immediately after

# ---

# ## üì• INPUT

# The `tutor_transcript` is in the invocation state - you can reference it from the conversation context.

# ---

# ## üé® PHASE STRUCTURE

# Each phase is a dictionary:
# ```python
# {
#     "phase_id": 1,
#     "voiceover_text": "exact text from tutor_transcript for this phase",
#     "visual_instruction": "EXPLICIT Manim instructions",
#     "animation_type": "Create"
# }
# ```

# ---

# ## üîß VISUAL INSTRUCTION RULES

# ### 1. Be EXPLICIT
# ‚úÖ "Create Rectangle at ORIGIN. Width: 4, Height: 2. Style: BLUE stroke width 3, BLACK fill opacity 1.0. Label 'Rectangle' ABOVE with 0.5 buffer."

# ‚ùå "Draw a rectangle and label it"

# ### 2. Container Styling (ALWAYS)
# ```
# "Style: Fill Color BLACK, Fill Opacity 1.0, Stroke Color [COLOR], Stroke Width 3"
# ```

# ### 3. Label Placement
# - Labels **OUTSIDE** objects
# - "Label 'A' placed ABOVE the box with 0.3 buffer"

# ### 4. Positioning
# - Specific: "to the RIGHT of", "at coordinates (2, 0, 0)"
# - NOT "next to it"

# ---

# ## üé¨ ANIMATION TYPES

# | Use Case | Type |
# |----------|------|
# | Draw shapes | `Create` |
# | Write text | `Write` |
# | Morph | `Transform` |
# | Grow | `GrowFromEdge` |
# | Emphasize | `Indicate` |
# | No change | `NoChange` |

# ---

# ## üì§ YOUR WORKFLOW

# 1. **Read** tutor_transcript from state
# 2. **Create** list of phase dictionaries
# 3. **Call the tool:** `set_manim_synchronized_transcript(new_manim_synchronized_transcript=[...])`
# 4. **Hand off:** `handoff_to_agent(agent_name="tts_phasewise_transcript_agent")`
# 5. **STOP** - your job is done

# ---

# **Now read the transcript, create phases, call the tool, and hand off.**
# """

#     tts_final_transcript_generator_system_prompt = """
#     You are the **TTS Transcript Optimizer** for audio generation.

#     ## üéØ YOUR MISSION

#     1. Read `manim_synchronized_transcript` from the invocation state
#     2. Add SSML break tags to each phase's voiceover_text
#     3. **Call `set_tts_phasewise_transcript(new_tts_phasewise_transcript=[...])`**
#     4. **STOP** - pipeline complete!

#     ---

#     ## üì• INPUT

#     The `manim_synchronized_transcript` is in the invocation state - read it from context.

#     ---

#     ## üé§ YOUR TASK

#     Transform each phase's `voiceover_text` into TTS-ready strings with SSML breaks.

#     Output: List of strings (one per phase, same order)

#     ---

#     ## ‚è±Ô∏è SSML BREAK RULES

#     **After sentences:** `<break time='0.4s'/>`
#     **After commas:** `<break time='0.3s'/>`
#     **Before emphasis:** `<break time='0.5s'/>`
#     **Complex visuals:** `<break time='0.6s'/>`
#     **End of EVERY phase:** `<break time='1.0s'/>` ‚Üê **MANDATORY**

#     ---

#     ## üì§ YOUR WORKFLOW

#     1. **Read** manim_synchronized_transcript from state
#     2. **For each phase:** Add SSML breaks, always end with `<break time='1.0s'/>`
#     3. **Call the tool:** `set_tts_phasewise_transcript(new_tts_phasewise_transcript=["...", "..."])`
#     4. **STOP** - Do NOT hand off, pipeline is complete!

#     ---

#     ## üìã EXAMPLE

#     **Input phases:**
#     ```python
#     [
#         {"phase_id": 1, "voiceover_text": "Let's start with a triangle.", ...},
#         {"phase_id": 2, "voiceover_text": "Now we add labels on each side.", ...}
#     ]
#     ```

#     **Your output:**
#     ```python
#     [
#         "Let's start with a triangle. <break time='1.0s'/>",
#         "Now we add labels on each side. <break time='1.0s'/>"
#     ]
#     ```

#     **Then call:** `set_tts_phasewise_transcript(new_tts_phasewise_transcript=[...])`

#     **Then STOP** - do not hand off!

#     ---

#     **Now read the phases, add breaks, call the tool, and STOP.**
#     """



#     #agents

#     tutor_transcript_generator_agent = Agent(
#         name="tutor_transcript_generator",
#         model=model,
#         tools=[set_tutor_transcript],
#         system_prompt=tutor_transcript_generator_system_prompt
#     )

#     manim_synchronized_transcript_generator_agent = Agent(
#         name="manim_synchronized_transcript_agent",
#         model=model,
#         tools=[set_manim_synchronized_transcript],
#         system_prompt=manim_synchronized_transcript_system_prompt
#     )

#     tts_phasewise_transcript_generator_agent = Agent(
#         name="tts_phasewise_transcript_agent",
#         model=model,
#         tools=[set_tts_phasewise_transcript],
#         system_prompt=tts_final_transcript_generator_system_prompt
#     )

#     initial_state = {
#         "tutor_transcript": "",
#         "manim_synchronized_transcript": [],
#         "tts_phasewise_transcript": [],
#     }

#     swarm = Swarm(
#         [tutor_transcript_generator_agent,manim_synchronized_transcript_generator_agent,tts_phasewise_transcript_generator_agent],
#         entry_point=tutor_transcript_generator_agent,           # Start with researcher (optional)
#         max_handoffs=20,                  # Maximum agent handoffs allowed
#         max_iterations=20,                
#         execution_timeout=180.0,          
#         node_timeout=60.0,               
#         repetitive_handoff_detection_window=8,
#         repetitive_handoff_min_unique_agents=3
#     )

#     swarmResult  = swarm(
#         prompt,
#         invocation_state=initial_state,   # <-- shared state here
#     )

#     print(f'swarmResult : {swarmResult}')

#     final_state = swarmResult.state           # or result.invocation_state depending on SDK version [web:24]
#     print(f'tutor_transcript : {final_state["tutor_transcript"]}')
#     print(f'manim_synchronized_transcript : {final_state["manim_synchronized_transcript"]}')
#     print(f'tts_phasewise_transcript : {final_state["tts_phasewise_transcript"]}')

#     return
##########################3